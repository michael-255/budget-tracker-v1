import{g as ae,r as A,e as E,aq as se,s as ne,ar as re,h as V,c as ue,as as de,a as ce,at as me,au as fe,av as pe,aw as ge,ah as ve,ax as be,ay as H,az as he,aA as ye,k as Se,K as _e,A as K,L as De,aB as xe,aC as _,D as y,S,N as Ee,m as J,n as Z,w as G,t as l,p as g,G as we,x as p,aD as Ce,V as Te,z as L,aE as P,Q as Fe,I as N,aF as Oe,H as ke,aG as Ne,X as ee,Z as Le}from"./index-63ca9a3c.js";import{Q as Ae}from"./QChip-df42d9fb.js";import{Q as Ie}from"./QSlider-26805811.js";import{c as Ve}from"./useDialogs-3310041d.js";import{_ as Re}from"./ResponsivePage.vue_vue_type_script_setup_true_lang-42ec6fdf.js";import{u as qe}from"./useRouting-5b808252.js";import"./TouchPan-8afb6f8b.js";import"./selection-98805e7f.js";import"./action-91bf94ea.js";import"./QItemSection-7ce6632d.js";import"./QList-6ae2ca5c.js";function U(a,i,w,v){const c=[];return a.forEach(f=>{v(f)===!0?c.push(f):i.push({failedPropValidation:w,file:f})}),c}function W(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),ne(a)}const ze={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ue=["rejected"];function $e({editable:a,dnd:i,getFileInput:w,addFilesToQueue:v}){const{props:c,emit:f,proxy:b}=ae(),h=A(null),C=E(()=>c.accept!==void 0?c.accept.split(",").map(o=>(o=o.trim(),o==="*"?"*/":(o.endsWith("/*")&&(o=o.slice(0,o.length-1)),o.toUpperCase()))):null),d=E(()=>parseInt(c.maxFiles,10)),T=E(()=>parseInt(c.maxTotalSize,10));function R(o){if(a.value)if(o!==Object(o)&&(o={target:null}),o.target!==null&&o.target.matches('input[type="file"]')===!0)o.clientX===0&&o.clientY===0&&se(o);else{const D=w();D&&D!==o.target&&D.click(o)}}function q(o){a.value&&o&&v(null,o)}function $(o,D,I,F){let r=Array.from(D||o.target.files);const n=[],t=()=>{n.length!==0&&f("rejected",n)};if(c.accept!==void 0&&C.value.indexOf("*/")===-1&&(r=U(r,n,"accept",e=>C.value.some(u=>e.type.toUpperCase().startsWith(u)||e.name.toUpperCase().endsWith(u))),r.length===0))return t();if(c.maxFileSize!==void 0){const e=parseInt(c.maxFileSize,10);if(r=U(r,n,"max-file-size",u=>u.size<=e),r.length===0)return t()}if(c.multiple!==!0&&r.length!==0&&(r=[r[0]]),r.forEach(e=>{e.__key=e.webkitRelativePath+e.lastModified+e.name+e.size}),F===!0){const e=I.map(u=>u.__key);r=U(r,n,"duplicate",u=>e.includes(u.__key)===!1)}if(r.length===0)return t();if(c.maxTotalSize!==void 0){let e=F===!0?I.reduce((u,O)=>u+O.size,0):0;if(r=U(r,n,"max-total-size",u=>(e+=u.size,e<=T.value)),r.length===0)return t()}if(typeof c.filter=="function"){const e=c.filter(r);r=U(r,n,"filter",u=>e.includes(u))}if(c.maxFiles!==void 0){let e=F===!0?I.length:0;if(r=U(r,n,"max-files",()=>(e++,e<=d.value)),r.length===0)return t()}if(t(),r.length!==0)return r}function j(o){W(o),i.value!==!0&&(i.value=!0)}function m(o){ne(o),(o.relatedTarget!==null||re.is.safari!==!0?o.relatedTarget!==h.value:document.elementsFromPoint(o.clientX,o.clientY).includes(h.value)===!1)===!0&&(i.value=!1)}function z(o){W(o);const D=o.dataTransfer.files;D.length!==0&&v(null,D),i.value=!1}function M(o){if(i.value===!0)return V("div",{ref:h,class:`q-${o}__dnd absolute-full`,onDragenter:W,onDragover:W,onDragleave:m,onDrop:z})}return Object.assign(b,{pickFiles:R,addFiles:q}),{pickFiles:R,addFiles:q,onDragover:j,onDragleave:m,processFiles:$,getDndNode:M,maxFilesNumber:d,maxTotalSizeNumber:T}}const je=ue({name:"QFile",inheritAttrs:!1,props:{...de,...ce,...ze,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...me,...Ue],setup(a,{slots:i,emit:w,attrs:v}){const{proxy:c}=ae(),f=fe(),b=A(null),h=A(!1),C=pe(a),{pickFiles:d,onDragover:T,onDragleave:R,processFiles:q,getDndNode:$}=$e({editable:f.editable,dnd:h,getFileInput:Y,addFilesToQueue:X}),j=ge(a),m=E(()=>Object(a.modelValue)===a.modelValue?"length"in a.modelValue?Array.from(a.modelValue):[a.modelValue]:[]),z=E(()=>H(m.value)),M=E(()=>m.value.map(s=>s.name).join(", ")),o=E(()=>he(m.value.reduce((s,x)=>s+x.size,0))),D=E(()=>({totalSize:o.value,filesNumber:m.value.length,maxFiles:a.maxFiles})),I=E(()=>({tabindex:-1,type:"file",title:"",accept:a.accept,capture:a.capture,name:C.value,...v,id:f.targetUid.value,disabled:f.editable.value!==!0})),F=E(()=>"q-file q-field--auto-height"+(h.value===!0?" q-file--dnd":"")),r=E(()=>a.multiple===!0&&a.append===!0);function n(s){const x=m.value.slice();x.splice(s,1),e(x)}function t(s){const x=m.value.indexOf(s);x>-1&&n(x)}function e(s){w("update:modelValue",a.multiple===!0?s:s[0])}function u(s){s.keyCode===13&&ye(s)}function O(s){(s.keyCode===13||s.keyCode===32)&&d(s)}function Y(){return b.value}function X(s,x){const k=q(s,x,m.value,r.value),Q=Y();Q!=null&&(Q.value=""),k!==void 0&&((a.multiple===!0?a.modelValue&&k.every(ie=>m.value.includes(ie)):a.modelValue===k[0])||e(r.value===!0?m.value.concat(k):k))}function B(){return[V("input",{class:[a.inputClass,"q-file__filler"],style:a.inputStyle})]}function oe(){if(i.file!==void 0)return m.value.length===0?B():m.value.map((x,k)=>i.file({index:k,file:x,ref:this}));if(i.selected!==void 0)return m.value.length===0?B():i.selected({files:m.value,ref:this});if(a.useChips===!0)return m.value.length===0?B():m.value.map((x,k)=>V(Ae,{key:"file-"+k,removable:f.editable.value,dense:!0,textColor:a.color,tabindex:a.tabindex,onRemove:()=>{n(k)}},()=>V("span",{class:"ellipsis",textContent:x.name})));const s=a.displayValue!==void 0?a.displayValue:M.value;return s.length!==0?[V("div",{class:a.inputClass,style:a.inputStyle,textContent:s})]:B()}function le(){const s={ref:b,...I.value,...j.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:X};return a.multiple===!0&&(s.multiple=!0),V("input",s)}return Object.assign(f,{fieldClass:F,emitValue:e,hasValue:z,inputRef:b,innerValue:m,floatingLabel:E(()=>z.value===!0||H(a.displayValue)),computedCounter:E(()=>{if(a.counterLabel!==void 0)return a.counterLabel(D.value);const s=a.maxFiles;return`${m.value.length}${s!==void 0?" / "+s:""} (${o.value})`}),getControlChild:()=>$("file"),getControl:()=>{const s={ref:f.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:a.tabindex};return f.editable.value===!0&&Object.assign(s,{onDragover:T,onDragleave:R,onKeydown:u,onKeyup:O}),V("div",s,[le()].concat(oe()))}}),Object.assign(c,{removeAtIndex:n,removeFile:t,getNativeElement:()=>b.value}),ve(c,"nativeEl",()=>b.value),be(f)}});function te(a){setTimeout(()=>{window.URL.revokeObjectURL(a.href)},1e4),a.remove()}function Me(a,i,w={}){const{mimeType:v,byteOrderMark:c,encoding:f}=typeof w=="string"?{mimeType:w}:w,b=f!==void 0?new TextEncoder(f).encode([i]):i,h=c!==void 0?[c,b]:[b],C=new Blob(h,{type:v||"application/octet-stream"}),d=document.createElement("a");d.href=window.URL.createObjectURL(C),d.setAttribute("download",a),typeof d.download>"u"&&d.setAttribute("target","_blank"),d.classList.add("hidden"),d.style.position="fixed",document.body.appendChild(d);try{return d.click(),te(d),!0}catch(T){return te(d),T}}const Pe={class:"q-mb-xl"},Be=l("div",{class:"text-h6 q-mb-md"},"Monthly Budget Target",-1),Ge=l("p",null," Choose a dollar amount for your monthly budget that makes sense for your current financial goals. This is the amount you will be trying to stay under each month. ",-1),We={class:"q-mb-xl"},Qe=l("p",{class:"text-h6"},"Options",-1),Ke={class:"q-mb-md"},Ye=l("p",null,"Reset your app Settings to the defaults without impacting any of your data.",-1),Xe={class:"q-mb-md"},He=l("p",null," Welcome overlay provides helpful instructions on basic app usage on the Dashboard page. ",-1),Je={class:"q-mb-md"},Ze=l("p",null,"Show descriptions for records displayed on the Dashboard page.",-1),et=l("p",null,"Dark mode allows you to switch between a light or dark theme for the app.",-1),tt={class:"q-mb-xl"},at=l("p",{class:"text-h6"},"Data Management",-1),nt={class:"q-mb-md"},ot=l("p",null," Import data into the database from a JSON file. The app expects the data in the file to be structured the same as the exported version. Logs are ignored during imports. ",-1),lt={class:"q-mb-md"},it=l("p",null," Export your data as a JSON file. Do this on a regularly basis so you have a backup of your data. ",-1),st={class:"q-mb-xl"},rt=l("p",{class:"text-h6"},"Logging",-1),ut={class:"q-mb-md"},dt=l("p",null,"View the app logs to troubleshoot issues.",-1),ct={class:"q-mb-md"},mt=l("p",null," Validate that the logging settings below are working as expected by generating some test logs. ",-1),ft={class:"q-mb-md"},pt=l("p",null,"Show Console Logs will display all log messages in the browser console.",-1),gt={class:"q-mb-md"},vt=l("p",null,"Show Info Messages will display info level notifications.",-1),bt={class:"q-mb-md"},ht=l("p",null," Change log retention duration below. Logs older than the selected time will be deleted. This functions retroactivley. Expired log processing occurs every time the app is loaded. ",-1),yt={class:"q-mx-lg"},St={class:"q-mb-xl"},_t=l("p",{class:"text-h6 text-negative"},"DANGER ZONE",-1),Dt=l("p",null," The following operations cannot be undone. Consider exporting your data before proceeding. ",-1),xt={class:"q-mb-md"},Et=l("p",null,"Delete the app logs from the database.",-1),wt={class:"q-mb-md"},Ct=l("p",null,"Permanently delete all data from the database.",-1),Tt={class:"q-mb-md"},Ft=l("p",null,"Delete the underlining database and all of its data (requires website reload).",-1),$t=Se({__name:"SettingsView",setup(a){_e({title:`${K} - Settings`});const{log:i}=De(),{notify:w}=xe(),{confirmDialog:v}=Ve(),{goToLogsData:c}=qe(),f=A([]),b=A(null),h=A(void 0),C=A(0),d=A(null),T=[_[_["One Week"]],_[_["One Month"]],_[_["Three Months"]],_[_["Six Months"]],_[_["One Year"]],_[_.Forever]],R=y.liveSettings().subscribe({next:n=>{var e,u;f.value=n;const t=(e=n.find(O=>O.key===S.LOG_RETENTION_DURATION))==null?void 0:e.value;C.value=T.findIndex(O=>O===_[t]),h.value=(u=n.find(O=>O.key===S.BUDGET_TARGET))==null?void 0:u.value},error:n=>{i.error("Error fetching live Settings",n)}});Ee(()=>{R.unsubscribe()});function q(){i.debug("This is a Debug Log",{name:"Debug"}),i.info("This is an Info Log",{name:"Info"}),i.warn("This is a Warning Log",{name:"Warning"}),i.error("This is an Error Log",{name:"Error"})}function $(n){var e,u;const t=((u=(e=n[0])==null?void 0:e.importFile)==null?void 0:u.name)||void 0;i.warn(`Cannot import"${t}`,n)}function j(){var n;v("Import",`Import backup data from ${(n=d==null?void 0:d.value)==null?void 0:n.name} and attempt to load records into the database from it?`,N.INFO,"info",async()=>{try{const t=JSON.parse(await d.value.text());if(i.silentDebug("backupData:",t),t.appName!==K)throw new Error(`Cannot import data from the app ${t.appName}`);t[ee.SETTINGS].length>0&&await Promise.all(t[ee.SETTINGS].filter(e=>Object.values(S).includes(e.key)).map(async e=>await y.setSetting(e.key,e.value))),await y.importExpenses(t[Le.EXPENSES]),d.value=null,i.info("Successfully imported available data")}catch(t){i.error("Error during import",t)}})}function m(){const n=K.toLowerCase().split(" ").join("-"),t=new Date().toISOString().split("T")[0],e=`export-${n}-${t}.json`;v("Export",`Export all data into the file "${e}" as a backup?`,N.INFO,"info",async()=>{try{const u=await y.getBackupData();if(i.silentDebug("backupData:",u),Me(e,JSON.stringify(u),{encoding:"UTF-8",mimeType:"application/json"})===!0)i.info("File downloaded successfully",{filename:e});else throw new Error("Browser denied file download")}catch(u){i.error("Export failed",u)}})}async function z(n){try{const t=T[n],e=_[t];await y.setSetting(S.LOG_RETENTION_DURATION,e),i.info("Updated log retention duration",{logDurationKey:t,logDuration:e,index:n})}catch(t){i.error("Log retention duration update failed",t)}}function M(){v("Reset Settings","Would you like to reset your app Settings to the defaults? This does not impact your data.",N.REFRESH,"primary",async()=>{try{await y.clearSettings(),i.info("Successfully reset settings")}catch(n){i.error("Error reseting settings",n)}})}function o(){v("Delete Logs","Permanetly delete all Logs from the database?",N.CLEAR,"negative",async()=>{try{await y.clearLogs(),i.info("Successfully deleted logs data")}catch(n){i.error("Error deleting Logs",n)}})}function D(){v("Delete All","Permanetly delete all data from the database?",N.CLEAR,"negative",async()=>{try{await y.clearAll(),i.info("All data successfully deleted")}catch(n){i.error("Error deleting all data",n)}})}function I(){v("Delete Database","Delete the underlining database? All data will be lost. You must reload the website after this action to reinitialize the database.",N.CLEAR,"negative",async()=>{try{await y.deleteDatabase(),w("Reload the website now",N.WARN,"warning")}catch(n){i.error("Database deletion failed",n)}})}function F(n){var t;return(t=f.value.find(e=>e.key===n))==null?void 0:t.value}async function r(){var n;h.value||(h.value=void 0),(n=b==null?void 0:b.value)!=null&&n.validate()&&await y.setSetting(S.BUDGET_TARGET,h.value)}return(n,t)=>(J(),Z(Re,{bannerIcon:p(N).SETTINGS,bannerTitle:"Settings"},{default:G(()=>[l("section",Pe,[Be,Ge,g(Te,{modelValue:h.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>h.value=e),t[1]||(t[1]=e=>r())],modelModifiers:{number:!0},ref_key:"budgetInputRef",ref:b,rules:[e=>p(Ce).optional().safeParse(e).success||"Must be a positive integar"],hint:"Auto Saved",type:"number",step:"1",placeholder:"Dollar Amount",dense:"",outlined:"",color:"primary"},{before:G(()=>[we(" $ ")]),_:1},8,["modelValue","rules"])]),l("section",We,[Qe,l("div",Ke,[Ye,g(L,{label:"Reset Settings",color:"primary",onClick:t[2]||(t[2]=e=>M())})]),l("div",Xe,[He,g(P,{label:"Show Welcome Overlay","model-value":F(p(S).WELCOME_OVERLAY),"onUpdate:modelValue":t[3]||(t[3]=e=>p(y).setSetting(p(S).WELCOME_OVERLAY,e))},null,8,["model-value"])]),l("div",Je,[Ze,g(P,{label:"Show Dashboard Descriptions","model-value":F(p(S).DASHBOARD_DESCRIPTIONS),"onUpdate:modelValue":t[4]||(t[4]=e=>p(y).setSetting(p(S).DASHBOARD_DESCRIPTIONS,e))},null,8,["model-value"])]),l("div",null,[et,g(P,{label:"Dark Mode","model-value":F(p(S).DARK_MODE),"onUpdate:modelValue":t[5]||(t[5]=e=>p(y).setSetting(p(S).DARK_MODE,e))},null,8,["model-value"])])]),l("section",tt,[at,l("div",nt,[ot,g(je,{modelValue:d.value,"onUpdate:modelValue":t[8]||(t[8]=e=>d.value=e),dense:"",outlined:"",counter:"","bottom-slots":"",label:"File Select","max-file-size":p(Ne).MAX_FILE_SIZE,accept:"application/json",onRejected:$},{before:G(()=>[g(L,{disable:!d.value,label:"Import",color:"primary",onClick:t[6]||(t[6]=e=>j())},null,8,["disable"])]),append:G(()=>[d.value?(J(),Z(Fe,{key:0,name:p(N).CLOSE,class:"cursor-pointer",onClick:t[7]||(t[7]=Oe(e=>d.value=null,["stop"]))},null,8,["name"])):ke("",!0)]),_:1},8,["modelValue","max-file-size"])]),l("div",lt,[it,g(L,{label:"Export",color:"primary",onClick:t[9]||(t[9]=e=>m())})])]),l("section",st,[rt,l("div",ut,[dt,g(L,{label:"Access Logs",color:"primary",onClick:t[10]||(t[10]=e=>p(c)())})]),l("div",ct,[mt,g(L,{label:"Test Logger",color:"primary",onClick:t[11]||(t[11]=e=>q())})]),l("div",ft,[pt,g(P,{label:"Show Console Logs","model-value":F(p(S).CONSOLE_LOGS),"onUpdate:modelValue":t[12]||(t[12]=e=>p(y).setSetting(p(S).CONSOLE_LOGS,e))},null,8,["model-value"])]),l("div",gt,[vt,g(P,{label:"Show Info Messages","model-value":F(p(S).INFO_MESSAGES),"onUpdate:modelValue":t[13]||(t[13]=e=>p(y).setSetting(p(S).INFO_MESSAGES,e))},null,8,["model-value"])]),l("div",bt,[ht,l("div",yt,[g(Ie,{modelValue:C.value,"onUpdate:modelValue":t[14]||(t[14]=e=>C.value=e),"label-value":T[C.value],color:"primary",markers:"","label-always":"","switch-label-side":"",min:0,max:T.length-1,onChange:t[15]||(t[15]=e=>z(e))},null,8,["modelValue","label-value","max"])])])]),l("section",St,[_t,Dt,l("div",xt,[Et,g(L,{label:"Delete Logs",color:"negative",onClick:t[16]||(t[16]=e=>o())})]),l("div",wt,[Ct,g(L,{label:"Delete All Data",color:"negative",onClick:t[17]||(t[17]=e=>D())})]),l("div",Tt,[Ft,g(L,{label:"Delete Database",color:"negative",onClick:t[18]||(t[18]=e=>I())})])])]),_:1},8,["bannerIcon"]))}});export{$t as default};
