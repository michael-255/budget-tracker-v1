import{Q as y,a as _,b as k,c as O}from"./QTable-a8fa4709.js";import{k as P,K as A,A as F,L as R,r as u,Y as U,D as x,N as j,m as c,n as E,w as s,p as t,F as C,O as T,J as Q,G as p,z as d,x as a,I as r,t as v,Q as V,V as z,v as h,W as G,Z as J,P as K,T as M}from"./index-54cdbb61.js";import{Q as W}from"./QSelect-b7396a45.js";import{u as X}from"./useRouting-f8a48c74.js";import{c as Y}from"./useDialogs-32c148ce.js";import"./QList-615720ed.js";import"./QChip-91adf3c4.js";import"./QItemSection-0e024dbb.js";import"./QItemLabel-3845f361.js";import"./QMenu-24dc43c6.js";import"./selection-1cdd424c.js";import"./action-dd1e0109.js";const Z={class:"row justify-start full-width q-mb-md"},H=v("div",{class:"col-10 text-h6 text-bold ellipsis"},"Expenses",-1),ee={class:"row justify-start full-width"},oe={class:"col-12"},fe=P({__name:"DataRecordsView",setup(le){A({title:`${F} - Expenses Data Table`});const{log:m}=R(),{goToEdit:S,goToCreate:q,goBack:I}=X(),{confirmDialog:B,inspectDialog:N}=Y(),f=u(""),i=u([]),w=u(U.getTableColumns()),D=u(w.value.filter(o=>!o.required)),b=u(D.value.map(o=>o.name)),g=x.liveExpenses().subscribe({next:o=>i.value=o,error:o=>m.error("Error fetching live expenses data",o)});j(()=>{g==null||g.unsubscribe()});async function L(o){B("Delete","Permanently delete this Expense record?",r.DELETE,"negative",async()=>{try{await x.deleteExpense(o),m.info("Successfully deleted expense",{id:o})}catch(l){m.error("Delete failed",l)}})}async function $(o){const l=await x.getExpense(o);l?N(l,J.EXPENSES):m.error("Failed to find record",{id:o})}return(o,l)=>(c(),E(O,{rows:i.value,columns:w.value,"visible-columns":b.value,"rows-per-page-options":[0],filter:f.value,"virtual-scroll":"",fullscreen:"","row-key":"id"},{header:s(e=>[t(_,{props:e},{default:s(()=>[(c(!0),C(Q,null,T(e.cols,n=>K((c(),E(y,{key:n.name,props:e},{default:s(()=>[p(h(n.label),1)]),_:2},1032,["props"])),[[M,n.name!=="hiddenId"]])),128)),t(y,{"auto-width":"",class:"text-left"},{default:s(()=>[p("Actions")]),_:1})]),_:2},1032,["props"])]),body:s(e=>[t(_,{props:e},{default:s(()=>[(c(!0),C(Q,null,T(e.cols,n=>(c(),E(k,{key:n.name,props:e},{default:s(()=>[p(h(n.value),1)]),_:2},1032,["props"]))),128)),t(k,{"auto-width":""},{default:s(()=>[t(d,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"primary",icon:a(r).INSPECT,onClick:n=>$(e.cols[0].value)},null,8,["icon","onClick"]),t(d,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"orange-9",icon:a(r).EDIT,onClick:n=>a(S)(e.cols[0].value)},null,8,["icon","onClick"]),t(d,{flat:"",round:"",dense:"",class:"q-ml-xs",color:"negative",onClick:n=>L(e.cols[0].value),icon:a(r).DELETE},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1032,["props"])]),top:s(()=>[v("div",Z,[H,t(d,{round:"",flat:"",class:"absolute-top-right q-mr-sm q-mt-sm",icon:a(r).CLOSE,onClick:l[0]||(l[0]=e=>a(I)())},null,8,["icon"])]),v("div",ee,[v("div",oe,[t(z,{disable:!i.value.length,outlined:"",dense:"",clearable:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=e=>f.value=e),placeholder:"Search"},{before:s(()=>[t(d,{color:"positive",class:"q-px-sm q-mr-xs",icon:a(r).ADD,onClick:l[1]||(l[1]=e=>a(q)())},null,8,["icon"]),t(W,{modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),options:D.value,disable:!i.value.length,"bg-color":"primary",standout:"",multiple:"",dense:"","options-dense":"","emit-value":"","map-options":"","option-value":"name","display-value":""},{prepend:s(()=>[t(V,{color:"white",name:a(r).OPTIONS},null,8,["name"])]),_:1},8,["modelValue","options","disable"])]),append:s(()=>[t(V,{name:"search"})]),_:1},8,["disable","modelValue"])])])]),bottom:s(()=>[p(h(a(G)(i.value)),1)]),_:1},8,["rows","columns","visible-columns","filter"]))}});export{fe as default};
